<!-- Creator     : groff version 1.23.0 -->
<!-- CreationDate: Thu Nov 27 23:27:27 2025 -->
<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN"
"http://www.w3.org/TR/html4/loose.dtd">
<html>
<head>
<meta name="generator" content="groff -Thtml, see www.gnu.org">
<meta http-equiv="Content-Type" content="text/html; charset=US-ASCII">
<meta name="Content-Style" content="text/css">
<style type="text/css">
       p       { margin-top: 0; margin-bottom: 0; vertical-align: top }
       pre     { margin-top: 0; margin-bottom: 0; vertical-align: top }
       table   { margin-top: 0; margin-bottom: 0; vertical-align: top }
       h1      { text-align: center }
</style>
<title>LDIRCACHE_REPAIR</title>

</head>
<body>

<h1 align="center">LDIRCACHE_REPAIR</h1>

<a href="#NAME">NAME</a><br>
<a href="#SYNOPSIS">SYNOPSIS</a><br>
<a href="#DESCRIPTION">DESCRIPTION</a><br>
<a href="#EXIT STATUS">EXIT STATUS</a><br>
<a href="#OPTIONS">OPTIONS</a><br>
<a href="#EXAMPLES">EXAMPLES</a><br>
<a href="#FILES">FILES</a><br>
<a href="#SEE ALSO">SEE ALSO</a><br>
<a href="#COPYRIGHT">COPYRIGHT</a><br>

<hr>


<h2>NAME
<a name="NAME"></a>
</h2>



<p style="margin-left:9%; margin-top: 1em">ldircache_repair
- repair a <i>open-lmake</i> repo</p>

<h2>SYNOPSIS
<a name="SYNOPSIS"></a>
</h2>



<p style="margin-left:9%; margin-top: 1em"><b>ldircache_repair</b>
[<i>-n</i>|<i>--dry-run</i>] <i>dir</i></p>

<h2>DESCRIPTION
<a name="DESCRIPTION"></a>
</h2>



<p style="margin-left:9%; margin-top: 1em"><i><b>ldircache_repair</b></i>
is meant to repair a dir-based cache (a cache whose tag is
<i>dir</i>). Its argument specifies the dir to repair.</p>

<p style="margin-left:9%; margin-top: 1em">This may be
usedful either because you experience incoherent behaviors
and this is less agressive than setting up a fresh dir.</p>

<p style="margin-left:9%; margin-top: 1em">Also, if for
some management reason you want to dismiss some entries, you
can remove any part of the cache and run this command to
restore a coherent state. The structure of the cache dir is
fairly simple: all the data linked to a job is under a dir
named after the job name.</p>

<p style="margin-left:9%; margin-top: 1em">When running,
<b>ldircache_repair</b> generates a trace of its activity.
These may be:</p>

<table width="100%" border="0" rules="none" frame="void"
       cellspacing="0" cellpadding="0">
<tr valign="top" align="left">
<td width="9%"></td>
<td width="6%">


<p>rm</p></td>
<td width="3%"></td>
<td width="82%">


<p>Any file not necessary for running the cache is
removed.</p> </td></tr>
<tr valign="top" align="left">
<td width="9%"></td>
<td width="6%">


<p>rmdir</p></td>
<td width="3%"></td>
<td width="82%">


<p>Any empty dir, possibly resulting from the <i>rm</i>
actions, are removed.</p></td></tr>
</table>

<p style="margin-left:9%;">erase entry</p>

<p style="margin-left:18%;">Any incomplete or otherwise
incoherent cache entry is removed.</p>

<p style="margin-left:9%;">rebuild lru</p>

<p style="margin-left:18%;">The book-keeping information to
ensure proper LRU evection is rebuilt. If the LRU data is
missing, the corresponding entry will be deemed to have been
accessed and will be preferred candidates for eviction.</p>

<h2>EXIT STATUS
<a name="EXIT STATUS"></a>
</h2>



<p style="margin-left:9%; margin-top: 1em"><b>ldircache_repair</b>
exits with a status of zero if the cache was successfully
repaired. Else it exits with a non-zero status:</p>

<table width="100%" border="0" rules="none" frame="void"
       cellspacing="0" cellpadding="0">
<tr valign="top" align="left">
<td width="9%"></td>
<td width="3%">


<p><b>2</b></p></td>
<td width="6%"></td>
<td width="82%">


<p>internal error, should not occur</p></td></tr>
<tr valign="top" align="left">
<td width="9%"></td>
<td width="3%">


<p><b>7</b></p></td>
<td width="6%"></td>
<td width="82%">


<p>adequate permissions were missing, typically write
access</p> </td></tr>
<tr valign="top" align="left">
<td width="9%"></td>
<td width="3%">


<p><b>10</b></p></td>
<td width="6%"></td>
<td width="82%">


<p>some syscall failed</p></td></tr>
<tr valign="top" align="left">
<td width="9%"></td>
<td width="3%">


<p><b>11</b></p></td>
<td width="6%"></td>
<td width="82%">


<p>bad usage : command line options and arguments coul not
be parsed</p></td></tr>
<tr valign="top" align="left">
<td width="9%"></td>
<td width="3%">


<p><b>12</b></p></td>
<td width="6%"></td>
<td width="82%">


<p>bad cache version, cache needs to be cleaned</p></td></tr>
</table>

<h2>OPTIONS
<a name="OPTIONS"></a>
</h2>


<p style="margin-left:9%; margin-top: 1em"><b>-n</b>,
<b>--dry-run</b></p>

<p style="margin-left:18%;">Report actions to carry out but
do not actually perform them.</p>


<p style="margin-left:9%; margin-top: 1em"><b>ldircache_repair</b>
manages a fully coherent dir called a repo. When it starts,
it first determines the root of the repo (cf. <b>FILES</b>
below).</p>

<p style="margin-left:9%; margin-top: 1em">Arguments and
reports are systematically localized to the current working
dir. For example, if you launch <b>ldircache_repair b</b>
from dir <b>a</b> in your repo, the argument is file
<i>a/b</i> from the root of the repo and reports containing
file names (initially seen from the root of the repo) will
be shown relative the the current working dir.</p>

<h2>EXAMPLES
<a name="EXAMPLES"></a>
</h2>



<p style="margin-left:9%; margin-top: 1em">ldircache_repair</p>

<h2>FILES
<a name="FILES"></a>
</h2>


<p style="margin-left:9%; margin-top: 1em">The files
<i>Lmakefile.py</i> or <i>Lmakefile/__init__.py</i> are
searched in the current dir and in parent dirs. If a single
one is found, this determines the root of the repo. If
several are found, the existence of an <i>LMAKE</i> dir is
checked. If a single one is found, this determines the root
of the repo. In other cases, <b>ldircache_repair</b> will
not start.</p>

<h2>SEE ALSO
<a name="SEE ALSO"></a>
</h2>



<p style="margin-left:9%; margin-top: 1em"><b>lautodep</b>(1),
<b>lcheck_deps</b>(1), <b>lcollect</b>(1), <b>ldebug</b>(1),
<b>ldecode</b>(1), <b>ldepend</b>(1), <b>lencode</b>(1),
<b>lforget</b>(1), <b>lmake</b>(1), <b>lmark</b>(1),
<b>lrepair</b>(1), <b>lrun_cc</b>(1), <b>lshow</b>(1),
<b>ltarget</b>(1), <b>xxhsum</b>(1)</p>

<p style="margin-left:9%; margin-top: 1em">The python
module <b>lmake</b>.</p>

<p style="margin-left:9%; margin-top: 1em">The full
<i>open-lmake</i> documentation in
<i>&lt;open-lmake-installation-dir&gt;/docs/index.html</i>.</p>

<h2>COPYRIGHT
<a name="COPYRIGHT"></a>
</h2>


<p style="margin-left:9%; margin-top: 1em">Copyright &copy;
2023-2025, Doliam. This file is part of
<i>open-lmake</i>.</p>


<p style="margin-left:9%; margin-top: 1em"><i>open-lmake</i>
is free software; you can redistribute it and/or modify it
under the terms of the GNU General Public License as
published by the Free Software Foundation, version 3 of the
License.</p>


<p style="margin-left:9%; margin-top: 1em"><i>open-lmake</i>
is distributed in the hope that it will be useful, but
WITHOUT ANY WARRANTY; without even the implied warranty of
MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the
GNU General Public License for more details.</p>

<p style="margin-left:9%; margin-top: 1em">You should have
received a copy of the GNU General Public License along with
this program. If not, see
<i>http://www.gnu.org/licenses/</i>.</p>
<hr>
</body>
</html>
